<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="三日月綾香" />
  <title>抓包登录大学教务系统</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/ayaka14732/syyon-vencie@a4c9a00/csslib/pandoc.css" />
  <link rel="stylesheet" href="/serif.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <!-- Others -->
  <meta property="og:image" content="https://avatars2.githubusercontent.com/u/68557794?s=400&u=343da7bebff676129e87341def71121ebffc4c9c&v=4"/>
  <script>
    window.addEventListener('DOMContentLoaded', function() {
      var xs = document.getElementsByTagName('code');
      for (var i = 0, len = xs.length; i < len; i++)
        xs[i].lang = 'en-x-code';
      xs = document.getElementsByClassName('footnote-back');
      for (var i = 0, len = xs.length; i < len; i++)
        xs[i].lang = 'en-x-code';
      document.querySelectorAll('div.sourceCode > pre').forEach(function(x) {
        x.classList.add('numberSource');
      });
    });
  </script>
  
</head>
<body>
<header id="title-block-header">
<h1 class="title">抓包登录大学教务系统</h1>
<p class="author">三日月綾香</p>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#前言">前言</a></li>
<li><a href="#实验步骤">实验步骤</a></li>
<li><a href="#实验总结">实验总结</a></li>
</ul>
</nav>
<h1 id="前言">前言</h1>
<p>本次实验基于 Kali Linux 环境，使用 Wireshark 软件抓取无线网络的数据包，分析其他使用者登录大学教务系统的数据，从而登录同学们的教务系统。</p>
<p>在 Kali Linux 中，使用 Aircrack-ng 系列工具，可以使无线网卡工作在监控模式下，从而抓取无线网络的 802.11 帧。大学的校园网的无线接入点为 WHU-STU，这是不经过加密的接入点，因此可以获取 802.11 帧中的数据。大学教务系统的 URL 为 <a href="http://218.197.150.140/" class="uri">http://218.197.150.140/</a>，只能使用 HTTP 协议连接，而非经过加密的 HTTPS，因此可以从 HTTP 请求中提取用户的登录信息。</p>
<p>在本次实验中，我使用笔记本电脑运行 Kali Linux 进行抓包，使用自己的智能手机模拟其他使用者登录教务系统。在抓取数据包后，使用分析获得的登录信息，在智能手机上重新登录教务系统成功，达到实验目的。</p>
<p>本次实验的目的仅在于学习网络安全知识，应对信息安全威胁，并防范自用 IT 基础设施受到攻击。本次实验没有侵犯他人的任何权利。对本实验报告的不当使用所导致的一切后果，作者不承担任何责任。</p>
<h1 id="实验步骤">实验步骤</h1>
<p>在 Kali Linux 中获取 WHU-STU 使用的信道：</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> iwlist wlan0 scanning</span></code></pre></div>
<figure>
<img src="scr3.png" alt="Get channel" /><figcaption aria-hidden="true">Get channel</figcaption>
</figure>
<p>由输出可知，WHU-STU 工作在信道 5。</p>
<p>使无线网卡工作在监控模式下：</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> airmon-ng check kill</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> airmon-ng start wlan0</span></code></pre></div>
<p>设置无线网卡监控信道 5：</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> iwconfig wlan0mon channel 5</span></code></pre></div>
<p>打开 Wireshark，选择 wlan0mon 开始抓包。</p>
<p>使用智能手机的浏览器打开大学教务系统 <a href="http://218.197.150.140/" class="uri">http://218.197.150.140/</a>，此时 Wireshark 中抓取到相应 IP 地址的 HTTP 数据包。</p>
<p>输入学号、密码与验证码并点击提交，此时 Wireshark 中抓取到 POST 请求，包含 <code>id</code>，<code>pwd</code> 与 <code>xdvfb</code> 三个字段。容易判断 <code>id</code> 是学号，<code>pwd</code> 是密码，<code>xdvfb</code> 是验证码。其中，学号与验证码通过明文传输，密码通过密文传输。</p>
<figure>
<img src="scr2.png" alt="Capture result" /><figcaption aria-hidden="true">Capture result</figcaption>
</figure>
<p>关闭 Wireshark。关闭无线网卡的监控模式，恢复正常连接：</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> airmon-ng stop wlan0mon</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> service network-manager start</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> ifconfig wlan0 up</span></code></pre></div>
<p>在浏览器中退出登录后，关闭浏览器的 JavaScript 功能。因为在登录前，网页会使用 JavaScript 对密码进行加密，再向服务器发送登录信息。若关闭 JavaScript 功能，使用抓取获得的密码的密文登录，网页将不会对密码进行处理。这与原来输入密码明文，并使用经过 JavaScript 加密后生成的密文登录等效。</p>
<figure>
<img src="mob1.jpg" alt="Log in page" /><figcaption aria-hidden="true">Log in page</figcaption>
</figure>
<figure>
<img src="mob2.png" alt="Log in result" /><figcaption aria-hidden="true">Log in result</figcaption>
</figure>
<p>输入学号、抓取获得的密码的密文和新的验证码并点击提交，可以成功登录教务系统。此时页面内容显示不完全，这是由于教务系统页面的部分内容通过 Ajax 动态加载，只需重新启用浏览器的 JavaScript 功能即可。</p>
<h1 id="实验总结">实验总结</h1>
<p>在本次实验中，我通过抓包获取大学教务系统的登录信息，并使用分析后得到的信息重新登录大学教务系统成功，达到了实验目的。</p>
<p>本次实验中，我遇到了较多问题，但都得到了解决。起初我使用 Windows 操作系统抓包，但由于与 Kali Linux 相比，Windows 操作系统在安全工具方面较为欠缺，不易配置无线网卡工作在监控模式下，因此只能抓取到本机的数据包，而不能抓取无线网络的所有 802.11 帧。</p>
<p>在 Kali Linux 中使用 Wireshark 抓包时，起初只能抓到少量的数据包，且大多为 802.11 帧的管理帧和控制帧，数据帧非常少。后来我设置无线网卡监控正确的信道，问题得到解决。</p>
<p>本次实验还存在许多可以改进之处。若无线接入点经过加密，可以通过字典攻击爆破密码。目前许多站点使用经过加密的 HTTPS 协议，但用户在访问网站时通常省略协议名，第一次连接仍然使用 HTTP 协议，可以在此时发起攻击。大学教务系统使用 MD5 对密码进行加密，对于弱密码可以使用彩虹表反查出对应的密码。</p>
<p>通过本次实验，我对 Kali Linux 的使用，特别是 Aircrack-ng 系列工具的使用有了基本的了解；对 Wireshark 的使用有了更深的认识。但更为重要的是，在帮助和鼓励下，我克服了一个个困难，掌握了更多的网络安全知识，实现了黑客梦，为青春增添了光辉灿烂的一笔！</p>
<p>（作于 2019 年 4 月 19 日，发布于 2019 年 5 月 20 日，发布时有删改）</p>
</body>
</html>
